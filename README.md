# 智能制造生产调度系统

基于遗传算法（GA）和局部搜索（ILS/VNS）的智能制造生产调度系统。

## 项目简介

### 问题背景

某智能制造工厂拥有三条生产线，每条生产线均可加工3种产品。企业每天早上8点根据当前订单情况生成未来一段时间的生产计划；当天8点之后到来的新订单，将在下一天早上8点统一纳入调度。

在订单具有不同交付期限和违约罚款的情况下，如何在有限产能和人工成本约束下合理安排生产，使企业总利润最大化，是一个典型的NP困难调度优化问题。

### 项目目标

本项目基于《计算智能》课程中所学的**遗传算法（GA）**和**局部搜索算法（ILS/VNS）**，设计并实现一套智能制造生产调度系统，完成：

- 生产计划自动生成
- 滚动重调度机制
- 结果可视化展示
- 多算法性能对比

### 核心算法

采用**"遗传算法（GA）+ 局部搜索（ILS/VNS）+ 滚动调度"**的混合计算智能框架：

- **遗传算法（GA）**: 全局搜索，优化生产线-时间-产品分配和订单优先级
- **局部搜索（ILS/VNS）**: 在GA最优解基础上进行精细优化
- **滚动调度**: 每日8点动态调度，适应新订单到来

## 主要特性

- ✅ **双层染色体编码**: Gene1（产线-时间-产品结构）+ Gene2（订单优先级）
- ✅ **智能解码策略**: 贪心分配算法，满足产能和截止时间约束
- ✅ **混合优化**: GA全局搜索 + ILS/VNS局部精化
- ✅ **滚动调度**: 支持每日动态重调度，冻结已执行时间段
- ✅ **多维度可视化**: 甘特图、收敛曲线、性能指标统计
- ✅ **可视化GUI**: 基于Streamlit的Web界面，支持配置管理和结果分析

## 项目结构

```
smart-scheduling/
├── 设计大纲.md              # 完整设计方案（问题建模+算法设计+实验方案）
├── 实现流程.md              # GUI实现流程指引
├── README.md               # 项目说明文档
├── requirements.txt        # Python依赖配置
├── gui_app.py              # GUI应用入口（Streamlit）
│
├── src/                    # 源代码目录
│   ├── main.py            # 命令行程序入口
│   ├── config.py          # 系统配置参数
│   ├── service.py         # 服务层（GUI调用接口）
│   │
│   ├── models/            # 数据模型模块
│   │   ├── order.py       # 订单类（产品类型、数量、截止时间等）
│   │   ├── chromosome.py  # 染色体类（Gene1 + Gene2）
│   │   └── schedule.py    # 调度方案类（分配方案、利润计算）
│   │
│   ├── ga/                # 遗传算法模块
│   │   ├── engine.py      # GA主引擎（种群管理、进化流程）
│   │   ├── operators.py   # 遗传操作（选择、交叉、变异）
│   │   ├── decoder.py     # 染色体解码器（生成调度方案）
│   │   └── fitness.py     # 适应度评估（利润计算）
│   │
│   ├── local_search/      # 局部搜索模块
│   │   └── ils_vns.py     # ILS/VNS实现（邻域操作、解精化）
│   │
│   ├── scheduler/         # 调度器模块
│   │   ├── order_manager.py      # 订单管理器（订单池维护）
│   │   └── rolling_scheduler.py  # 滚动调度器（每日8点调度）
│   │
│   └── visualization/     # 可视化模块
│       ├── gantt.py       # 甘特图生成
│       └── metrics.py     # 性能指标可视化
│
├── data/                  # 数据文件目录
│   ├── sample_orders_small.csv   # 小规模订单样本（20个订单）
│   └── sample_orders_medium.csv  # 中等规模订单样本（50个订单）
│
├── output/                # 输出文件目录
│   ├── gantt_chart.png    # 生产甘特图
│   ├── profit_breakdown.png      # 利润分解图
│   ├── order_completion.png      # 订单完成情况
│   └── line_utilization.png      # 产线利用率
│
└── docs/                  # 文档目录
    ├── ALGORITHM.md       # 算法设计文档
    ├── ARCHITECTURE.md    # 系统架构文档
    ├── EXPERIMENT.md      # 实验方案文档
    ├── REPORT_SKELETON.md # 论文写作提纲
    ├── GUI使用说明.md     # GUI界面使用指南
    ├── 指标说明.md        # 评价指标详细说明
    ├── 更新说明.md        # 版本更新记录
    ├── 滚动调度修复说明.md # 滚动调度机制说明
    └── 罚款机制说明.md    # 罚款计算机制说明
```

## 环境安装

### 系统要求

- Python 3.8 或更高版本
- 操作系统：Windows / Linux / macOS

### 安装依赖

使用 pip 安装项目所需的 Python 库：

```bash
pip install -r requirements.txt
```

主要依赖包括：
- `numpy`: 数值计算
- `pandas`: 数据处理
- `matplotlib`: 图表绘制
- `seaborn`: 统计可视化
- `scipy`: 科学计算
- `streamlit`: GUI界面框架
- `plotly`: 交互式图表

## 运行方法

### 方式一：GUI界面（推荐）

启动可视化Web界面：

```bash
streamlit run gui_app.py
```

浏览器会自动打开 `http://localhost:8501`，提供完整的可视化操作界面。

**GUI功能**：
- 📋 配置管理：可视化编辑算法参数
- 📦 订单管理：上传CSV或使用示例数据
- 🚀 调度运行：一键执行调度算法
- 📊 结果分析：查看甘特图和性能指标

详细使用说明请参考：[GUI使用说明](docs/GUI使用说明.md)

### 方式二：命令行运行

运行演示程序：

```bash
python src/main.py
```

### 使用自定义数据

1. 准备订单数据CSV文件，格式参考 `data/sample_orders_small.csv`
2. 修改 `src/config.py` 中的参数配置
3. 运行主程序（GUI或命令行）

### 配置说明

在 `src/main.py` 和 `src/config.py` 中可以配置：

**GA参数**：
- `POPULATION_SIZE`: 种群规模（默认30）
- `MAX_GENERATIONS`: 最大迭代次数（默认50）
- `CROSSOVER_RATE`: 交叉率（默认0.8）
- `MUTATION_RATE`: 变异率（默认0.1）
- `ELITE_SIZE`: 精英个体数（默认3）

**局部搜索参数**：
- `MAX_LS_ITERATIONS`: 最大迭代次数（默认50）

**生产参数**：
- `NUM_LINES`: 生产线数量（默认3）
- `NUM_PRODUCTS`: 产品种类（默认3）
- `SLOTS_PER_DAY`: 每天时间段数（默认6，每段4小时）
- `CAPACITY`: 各产品的产能限制

**成本参数**：
- `LABOR_COSTS`: 人工成本数组（每个时间段的成本）
  - 示例：`[100, 100, 115, 135, 150, 140]` 表示6个时段的成本
  - 越偏离正常工作时间，成本越高
- `PENALTY_RATE`: 罚款比例（默认0.1，即10%）
  - 未完成订单罚款 = 订单总金额 × 10%

## 算法说明

详细算法设计请参考：
- [算法设计文档](docs/ALGORITHM.md)
- [系统架构文档](docs/ARCHITECTURE.md)
- [实验方案文档](docs/EXPERIMENT.md)
- [设计大纲](设计大纲.md)

## 评价指标

### 财务指标
- **总收入**: 所有完成订单的收入总和
- **总成本**: 人工成本（每个工作时段的成本累加）
- **总罚款**: 未完成订单的罚款（订单总金额 × 10%）
- **总利润**: 收入 - 成本 - 罚款

### 订单指标
- **订单完成率**: 完全完成的订单数 / 总订单数
- **按期完成率**: 在截止时间前完成的订单比例
- **平均完成率**: 所有订单的平均完成百分比

### 生产指标
- **产线利用率**: 各生产线的工作时段占比
- **工作时段数**: 实际使用的生产时段总数
- **算法运行时间**: GA + 局部搜索的总耗时

## 作者

课程大作业项目

## 许可证

MIT License
"# ss" 
